<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sensor Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="img\11.png" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="/css/navbar.css" />
    <link rel="stylesheet" href="/css/font.css" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <nav class="navbar">
      <!-- Left: Logo & Menu -->

      <div class="logo">
        <a href="#hydroponics">
          <img src="img/nav-logo.png" alt="Hydroponics Logo" />
        </a>
      </div>

      <!-- Desktop Nav Links -->
      <ul>
        <li class="nav-item"><a href="Hydrophonics.html" class="nav-link">Dashboard</a></li>
        <li class="nav-item"><a href="Analytics.html" class="nav-link">Analytics</a></li>
        <li class="nav-item"><a href="#" class="nav-link">Reports</a></li>
      </ul>

      <!-- Right: Date & Time -->
      <div id="dateTime" class="date-time"></div>
    </nav>



    

    <!-- Real time and date script -->
    <script>
      function updateDateTime() {
        const now = new Date();
        const options = {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
          hour12: true,
        };
        document.getElementById("dateTime").textContent = now.toLocaleString("en-US", options);
      }

      setInterval(updateDateTime, 1000);
      updateDateTime();
    </script>

    <!-- Chart script -->
    <script>
      function createChart(canvasId, percentage) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) {
          console.error(`Canvas ID '${canvasId}' not found!`);
          return;
        }

        const ctx = canvas.getContext("2d");

        return new Chart(ctx, {
          type: "doughnut",
          data: {
            datasets: [
              {
                data: [percentage, 100 - percentage], // Percentage value
                backgroundColor: ["#36A2EB", "#E5E7EB"], // Blue for actual value, Light Gray for remaining
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "80%", // Controls doughnut size
            plugins: {
              legend: { display: false },
              tooltip: { enabled: false },
            },
          },
          plugins: [
            {
              afterDraw: function (chart) {
                const { width, height, ctx } = chart;

                ctx.restore();
                const fontSize = (height / 6).toFixed(2);
                ctx.font = fontSize + "px Arial";
                ctx.textBaseline = "middle";

                const text = percentage + "%",
                  textX = Math.round((width - ctx.measureText(text).width) / 2),
                  textY = height / 2;

                ctx.fillStyle = "#3D4852";
                ctx.fillText(text, textX, textY);
                ctx.save();
              },
            },
          ],
        });
      }

      // Initialize Charts with Correct IDs and Values (Ensure IDs exist in HTML)
      const charts = {
        phSensor: createChart("phSensor", 60),
        ecSensor: createChart("ecSensor", 75),
        lightSensor: createChart("lightSensor", 80),
        tempSensor: createChart("tempSensor", 50),
        humiditySensor: createChart("humiditySensor", 40),
        totalDissolvedSolids: createChart("totalDissolvedSolids", 65),
        waterTempSensor: createChart("waterTempSensor", 55),
        waterLvlSensor: createChart("waterLvlSensor", 30),
      };
    </script>

    <!-- For Navbar Hover effect -->
    <script>
      // Get the current URL path
      const currentPage = window.location.pathname.split("/").pop();

      // Select all nav links
      const navLinks = document.querySelectorAll(".nav-link");

      // Loop through links and apply active styling if it matches
      navLinks.forEach((link) => {
        if (link.getAttribute("href") === currentPage) {
          link.classList.add("text-green-400", "font-semibold");
        }
      });
    </script>
  </body>
</html>
