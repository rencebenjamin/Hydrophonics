<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sensor Dashboard</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="img\11.png" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="fixed top-0 left-0 w-full bg-white text-black px-16 py-2 flex items-center justify-center gap-x-56 shadow-md z-50">
      <!-- Left: Logo & Navigation Links (Grouped together) -->
      <div class="flex items-center space-x-6 text-lg font-bold">
        <a href="#hydroponics">
          <img src="img/11.png" class="h-12 w-auto max-w-[120px]" alt="Hydroponics Logo" />
        </a>
        <a href="Hydrophonics.html" class="nav-link hover:text-green-400 transition">Dashboard</a>
        <a href="Analytics.html" class="nav-link hover:text-green-400 transition">Analytics</a>
      </div>

      <!-- Right: Date & Time -->
      <div id="dateTime" class="text-lg font-bold"></div>
    </nav>

    <!-- Main Content -->
    <main class="mt-[60px] p-5">
      <header class="text-center">
        <h1 class="text-2xl text-[#485935] font-semibold">REAL-TIME MONITORING AND PREDICTIONS</h1>
      </header>

      <!-- <div class="chart-wrapper">
        <canvas id="pHSensor" class="chart-container"></canvas>
        <canvas id="ECSensor" class="chart-container"></canvas>
        <canvas id="lightSensor" class="chart-container"></canvas>
        <canvas id="tempSensor" class="chart-container"></canvas>
        <canvas id="humiditySensor" class="chart-container"></canvas>
        <canvas id="totalSolid" class="chart-container"></canvas>
            <canvas id="waterTempSensor" class="chart-container"></canvas>
            <canvas id="waterLvlSensor" class="chart-container"></canvas>
        </div> -->

      <section class="dashboard__cards grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 max-w-[850px] mx-auto">
        <!-- pH Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <p class="dashboard__card-content">
              <canvas id="phSensor" class="chart-container"></canvas>
            </p>
            <div class="dashboard__card-details" id="phDetails"></div>
          </div>
          <div class="row">
            <img src="img/ph.png" class="cards_logo" />
            <h3 class="dashboard__card-title">pH Sensor</h3>
          </div>
        </div>

        <!-- EC Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <p class="dashboard__card-content">
              <canvas id="ecSensor" class="chart-container"></canvas>
            </p>
            <div class="dashboard__card-details" id="ecDetails"></div>
          </div>
          <div class="row">
            <img src="img/ecuador.png" class="cards_logo" />
            <h3 class="dashboard__card-title">EC Sensor</h3>
          </div>
        </div>

        <!-- Light Intensity Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <p class="dashboard__card-content">
              <canvas id="lightSensor" class="chart-container"></canvas>
            </p>
            <div class="dashboard__card-details" id="lightSensorDetails"></div>
          </div>
          <div class="row">
            <img src="img\light.png" class="cards_logo" />
            <h3 class="dashboard__card-title">Light Intensity Sensor</h3>
          </div>
        </div>

        <!-- Temperature Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <p class="dashboard__card-content">
              <canvas id="tempSensor" class="chart-container"></canvas>
            </p>
            <div class="row">
              <img src="img\thermometer.png" class="cards_logo" />
              <h3 class="dashboard__card-title">Temperature Sensor</h3>
            </div>
          </div>
        </div>

        <!-- Humidity Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <img src="img\humidity.png" class="cards_logo" />
            <h3 class="dashboard__card-title">Humidity Sensor</h3>
          </div>
          <div class="row2">
            <p class="dashboard__card-content">
              <canvas id="humiditySensor" class="chart-container"></canvas>
            </p>
            <div class="dashboard__card-details" id="humidityDetails">
              <p>
                <strong>Dew Point:</strong>
                <span id="humidityDewPoint">18°C</span>
              </p>
              <p>
                <strong>Absolute Humidity:</strong>
                <span id="humidityAbsolute">10 g/m³</span>
              </p>
            </div>
          </div>
        </div>

        <!-- Dissolved Oxygen Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <img src="img\beaker-glass.png" class="cards_logo" />
            <h3 class="dashboard__card-title">Total Dissolved Solids</h3>
          </div>
          <div class="row2">
            <p class="dashboard__card-content"><strong>PPM Level:</strong> <span id="doLevel">300</span></p>
            <div class="dashboard__card-details" id="doDetails">
              <p><strong>min:</strong> <span id="doSaturation">550</span></p>
              <p><strong>max:</strong> <span id="doTemp">850</span></p>
            </div>
          </div>
        </div>

        <!-- Water Temperature Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <img src="img\water-temperature.png" class="cards_logo" />
            <h3 class="dashboard__card-title">Water Temperature Sensor</h3>
          </div>
          <div class="row2">
            <p class="dashboard__card-content"><strong>Water Temp:</strong> <span id="waterTempValue">20°C</span></p>
            <div class="dashboard__card-details" id="waterTempDetails">
              <p><strong>Min:</strong> <span id="waterTempMin">18°C</span></p>
              <p><strong>Max:</strong> <span id="waterTempMax">22°C</span></p>
            </div>
          </div>
        </div>

        <!-- Water Sensor -->
        <div
          class="w-[200px] h-[300px] bg-[#93a267] p-2 rounded-lg shadow-md cursor-pointer transition-transform duration-300 flex flex-col justify-center items-center text-center hover:shadow-lg hover:scale-105"
        >
          <div class="row2">
            <img src="img\water-level.png" class="cards_logo" />
            <h3 class="dashboard__card-title">Water Level Sensor</h3>
          </div>
          <div class="row2">
            <p class="dashboard__card-content">
              <strong>Water Level:</strong>
              <span id="waterLevelValue">20%</span>
            </p>
            <div class="dashboard__card-details" id="waterTempDetails">
              <p>
                <strong>Min water level:</strong>
                <span id="waterTempMin">40%</span>
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Bottom Sections Container -->
      <div class="dashboard__bottom-container">
        <!-- Sensor Graphs Dashboard (First Column) -->
        <section class="dashboard__bottom">
          <div class="dashboard__bottom-column">
            <div class="dashboard__grafana">
              <h3 class="dashboard__card-title">SENSOR GRAPHS</h3>
              <div class="grafana-container">
                <iframe
                  id="grafanaFrame"
                  src="http://localhost:3000/d-solo/becswr8bew2rkf/test-dashboard?orgId=1&from=1740116196107&to=1740116496107&timezone=browser&refresh=5s&theme=light&panelId=1&__feature.dashboardSceneSolo"
                  width="450"
                  height="200"
                  frameborder="0"
                  class="grafana-iframe"
                >
                </iframe>
              </div>
              <!-- Refresh Button -->
              <button class="refresh-button" onclick="resetGrafana()">Reset Graph</button>
            </div>
          </div>
        </section>

        <!-- Summary Card (Second Column) -->
        <section class="dashboard__bottom">
          <div class="dashboard__bottom-column">
            <div class="dashboard__card dashboard__card--large" id="summaryCard">
              <h3 class="dashboard__card-title">Summary</h3>
              <p class="dashboard__card-content" id="summaryContent">Summary of all sensors will appear here.</p>
            </div>
          </div>
        </section>
      </div>
    </main>

    <!-- Real time and date script -->
    <script>
      function updateDateTime() {
        const now = new Date();
        const options = {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
          hour12: true,
        };
        document.getElementById("dateTime").textContent = now.toLocaleString("en-US", options);
      }

      setInterval(updateDateTime, 1000);
      updateDateTime();
    </script>

    <!-- Chart script -->
    <script>
      function createChart(canvasId, percentage) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) {
          console.error(`Canvas ID '${canvasId}' not found!`);
          return;
        }

        const ctx = canvas.getContext("2d");

        return new Chart(ctx, {
          type: "doughnut",
          data: {
            datasets: [
              {
                data: [percentage, 100 - percentage], // Percentage value
                backgroundColor: ["#36A2EB", "#E5E7EB"], // Blue for actual value, Light Gray for remaining
                borderWidth: 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: "80%", // Controls doughnut size
            plugins: {
              legend: { display: false },
              tooltip: { enabled: false },
            },
          },
          plugins: [
            {
              afterDraw: function (chart) {
                const { width, height, ctx } = chart;

                ctx.restore();
                const fontSize = (height / 6).toFixed(2);
                ctx.font = fontSize + "px Arial";
                ctx.textBaseline = "middle";

                const text = percentage + "%",
                  textX = Math.round((width - ctx.measureText(text).width) / 2),
                  textY = height / 2;

                ctx.fillStyle = "#3D4852";
                ctx.fillText(text, textX, textY);
                ctx.save();
              },
            },
          ],
        });
      }

      // Initialize Charts with Correct IDs and Values (Ensure IDs exist in HTML)
      const charts = {
        phSensor: createChart("phSensor", 60), // Replace with actual % values
        ecSensor: createChart("ecSensor", 75),
        lightSensor: createChart("lightSensor", 80),
        tempSensor: createChart("tempSensor", 50),
        humiditySensor: createChart("humiditySensor", 40),
        totalSolid: createChart("totalSolid", 65),
        waterTempSensor: createChart("waterTempSensor", 55),
        waterLvlSensor: createChart("waterLvlSensor", 30),
      };
    </script>

    <!-- For Navbar Hover effect -->
    <script>
      // Get the current URL path
      const currentPage = window.location.pathname.split("/").pop();

      // Select all nav links
      const navLinks = document.querySelectorAll(".nav-link");

      // Loop through links and apply active styling if it matches
      navLinks.forEach((link) => {
        if (link.getAttribute("href") === currentPage) {
          link.classList.add("text-green-400", "font-semibold");
        }
      });
    </script>

    
  </body>
</html>
